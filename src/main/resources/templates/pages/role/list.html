<!DOCTYPE html>
<!--[if IE 8]> 
<html lang="cn" class="ie8"
 xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"> 
<![endif]-->
<!--[if !IE]><!-->
<html lang="cn" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" >
<!--<![endif]-->
<head>
	<meta charset="utf-8" />
	<title>项目信息管理平台</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	
	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
	<link th:href="@{/assets/plugins/jquery-ui/jquery-ui.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/plugins/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/plugins/font-awesome/css/all.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/plugins/ionicons/css/ionicons.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/plugins/animate/animate.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/css/apple/style.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/css/apple/style-responsive.min.css}" rel="stylesheet" />
	<link th:href="@{/assets/css/apple/theme/default.css}" rel="stylesheet" id="theme" />
	<!-- ================== END BASE CSS STYLE ================== -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script th:src="@{/assets/plugins/pace/pace.min.js}"></script>
	<script th:src="@{/assets/plugins/jquery/jquery-3.3.1.min.js}"></script>
	<!-- ================== END BASE JS ================== -->
	<!-- ================== END BASE JS ================== -->
	<style type="text/css">
		.dataTables_filter{
			text-align: right;
		}
		.hand{
			cursor: pointer;
		}
		.cssCheckboxAll{
			margin-top: -24px;
		}
		
		.cssTabCheckBox{
			margin-top: -6px;
		}
	</style>
</head>
<body>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show"><span class="spinner"></span></div>
	<!-- end #page-loader -->
	
	<!-- begin #page-container -->
	<div id="page-container" class="page-container fade page-sidebar-fixed page-header-fixed">
		<!-- begin #header -->
		<div th:include="pages/layout/head :: head"></div>
		<!-- end #header -->
		
		<!-- begin #sidebar -->
		<!-- 左侧菜单 -->
		<div th:include="pages/layout/left :: left('employee','role')"></div>
		<!-- end #sidebar -->
		
		<!-- begin #content -->
		<div id="content" class="content">
			<!-- begin breadcrumb -->
			<ol class="breadcrumb pull-right">
				<li class="breadcrumb-item">角色管理</li>
				<li class="breadcrumb-item">
					<a data-toggle="ajax" th:href="@{/role/query}">角色信息</a>
				</li>
				<li class="breadcrumb-item active">
					角色列表
				</li>
			</ol>
			<!-- end breadcrumb -->
			<!-- begin page-header -->
			<h1 class="page-header">&nbsp;<small></small></h1>
			<!-- end page-header -->
			
			<!-- begin panel -->
			<div class="panel panel-inverse">
				<div class="panel-heading">
					<div class="panel-heading-btn">
						<a href="javascript:;" th:onclick="'location.href=\'' + @{/} + 'role/edit\';'" class="btn btn-xs btn-icon btn-circle btn-default">
							<i class="fa fa-plus"></i>
						</a>
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default delChecked">
							<i class="fa fa-trash-alt"></i>
						</a>
					</div>
					<h4 class="panel-title">角色列表</h4>
				</div>
				<div class="panel-body">
					<form th:action="@{/role/query}" method="get" autocomplete="off">
						<div class="dataTables_wrapper form-inline dt-bootstrap no-footer">
							<div class="row">
								<div class="col-sm-12">
									<div class="dataTables_filter">
										<label>
											<i class="ion-ios-search fa-2x fa-fw pull-right m-r-0 text-black-lighter hand"></i>
											<input type="text" name="paramQuery" th:value="${paramQuery}" class="form-control input-sm pull-right" placeholder="请输入查询条件" aria-controls="data-table-default">
										</label>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12 table-responsive">
									<table id="data-table-default" class="table table-striped table-bordered dataTable no-footer dtr-inline table-hover">
										<thead>
											<tr>
												<th width="5px">
													<div class="checkbox checkbox-css">
														<input type="checkbox" id="cssCheckboxAll" value="" />
														<label for="cssCheckboxAll">&nbsp;</label>
													</div>
												</th>
												<th class="text-nowrap" width="220px">角色名称</th>
												<th class="text-nowrap" width="100px">角色类型</th>
												<th class="text-nowrap" style="min-width: 300px;">描述信息</th>
												<th class="text-nowrap" width="80px">操作</th>
											</tr>
										</thead>
										<tbody>
											<tr class="gradeA odd" th:if="${#lists.isEmpty(list)}">
												<td colspan="11" style="text-align: center;">没有查询到匹配的信息</td>
											</tr>
											<tr class="odd gradeA" th:each="r:${list}">
												<td>
													<div class="checkbox checkbox-css cssTabCheckBox">
				                                         <input type="checkbox" name="roleIds" th:id="${'cssCheckbox' + r.id}" th:value="${r.id}" />
				                                         <label class="hand" th:for="${'cssCheckbox' + r.id}">&nbsp;</label>
				                                     </div>
												</td>
												<td th:text="${r.name}"></td>
												<td th:text="${r.type eq 0 ? '内置角色' : '自定义角色'}"></td>
												<td th:text="${r.description}"></td>
												<td>
													<a href="javascript:;" title="查看详情" th:onclick="'location.href=\'' + @{/} + 'role/edit?id=' + ${r.id} + '\';'" class="btn btn-xs btn-icon btn-circle btn-default"><i class="fas fa-lg fa-fw m-r-10 fa-edit"></i></a>
													<a href="javascript:;" th:if="${r.type eq 1}" title="删除角色" th:id="${r.id}" class="btn btn-xs btn-icon btn-circle btn-default del"><i class="fas fa-lg fa-fw m-r-10 fa-trash-alt"></i></a>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-12">
									<div th:include="pages/commons/page :: page"></div>
								</div>
							</div>
						</div>
					</form>
					<form id="deleteForm" th:action="@{/role/delete}" method="post">
						<input type="hidden" name="ids" />
					</form>
				</div>
			</div>
			<!-- end panel -->
		</div>
		<!-- end #content -->
		
		<!-- begin scroll to top btn -->
		<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
		<!-- end scroll to top btn -->
	</div>
	<!-- end page container -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script th:src="@{/assets/plugins/jquery-ui/jquery-ui.min.js}"></script>
	<script th:src="@{/assets/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
	<!--[if lt IE 9]>
		<script th:src="@{/assets/crossbrowserjs/html5shiv.js}"></script>
		<script th:src="@{/assets/crossbrowserjs/respond.min.js}"></script>
		<script th:src="@{/assets/crossbrowserjs/excanvas.min.js}"></script>
	<![endif]-->
	<script th:src="@{/assets/plugins/slimscroll/jquery.slimscroll.min.js}"></script>
	<script th:src="@{/assets/plugins/js-cookie/js.cookie.js}"></script>
	<script th:src="@{/assets/js/theme/apple.min.js}"></script>
	<script th:src="@{/assets/js/apps.min.js}"></script>
	<!-- ================== END BASE JS ================== -->
	<!-- 模态框  BEGIN-->
	<script src="../assets/plugins/gritter/js/jquery.gritter.js"></script>
	<script src="../assets/plugins/bootstrap-sweetalert/sweetalert.min.js"></script>
	<!-- 模态框  END-->
	<!-- ================== END PAGE LEVEL JS ================== -->
	<script type="text/javascript" th:src="@{/javascript/custom/bugbycode.js}"></script>
	<script type="text/javascript">
		$("input[name='paramQuery']").keypress(function(event){
			if(event.keyCode == 13){
				query();
			}
		});
		$(".ion-ios-search").click(function(){
			query();
		});
		
		$("#cssCheckboxAll").click(function(){
			if($(this).prop("checked")){
				$("div.checkbox").find("input").prop("checked",true);
			}else{
				$("div.checkbox").find("input").prop("checked",false);
			}
		});
		
		function delChecked(e){
			var ids = "";
			$("input[name='roleIds']:checked").each(function(){
				if(ids != ""){
					ids += ",";
				}
				ids += $(this).val();
			});
			if(ids == ""){
				e.preventDefault();
				swal({
					title: '请选择要删除的角色！',
					text: '',
					icon: 'warning',
					buttons: {
						confirm: {
							text: '确定',
							value: true,
							visible: true,
							className: 'btn btn-warning',
							closeModal: true
						}
					}
				})
			}else{
				del(e,ids);
			}
		}
		
		function del(e,ids){
			e.preventDefault();
			swal({
				title: '您确定删除所选的角色吗？',
				text: '您执行该操作后角色会被永久删除，是否继续？',
				icon: 'warning',
				buttons: {
					cancel: {
						text: '取消',
						value: false,
						visible: true,
						className: 'btn btn-default',
						closeModal: true,
					},
					confirm: {
						text: '确定',
						value: true,
						visible: true,
						className: 'btn btn-warning',
						closeModal: true
					}
				}
			}).then(function(value){
				if(value == true){
					$("#deleteForm").find("input[name='ids']").val(ids);
					$("#deleteForm").submit();
				}
			});
		}
		
		$(".delChecked").click(function(e){
			delChecked(e);
		});
		
		$(".del").click(function(e){
			del(e,$(this).prop("id"));
		});
	</script>
</body>
</html>